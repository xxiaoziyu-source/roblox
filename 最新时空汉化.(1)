-- 先尝试加载 WindUI
local success, err = pcall(function()
    WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()
end)

-- 渐变文字函数
function gradient(text, startColor, endColor)
    local result = ""
    local length = #text
    
    for i = 1, length do
        local t = (i - 1) / math.max(length - 1, 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)

        local char = text:sub(i, i)
        result = result .. "<font color=\"rgb(" .. r ..", " .. g .. ", " .. b .. ")\">" .. char .. "</font>"
    end
    
    return result
end

if not success then
    warn("WindUI 加载失败，将使用备用方案")
    -- 备用方案：本地模拟界面
    local Plr = game:GetService("Players").LocalPlayer
    local Gui = Instance.new("ScreenGui", Plr.PlayerGui)
    local MainFrame = Instance.new("Frame", Gui)
    MainFrame.Size = UDim2.fromOffset(400, 350)
    MainFrame.Position = UDim2.fromScale(0.5, 0.5)
    MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    MainFrame.BackgroundTransparency = 0.3

    -- 彩虹边框动画
    local borders = {
        Top = Instance.new("Frame", MainFrame),
        Right = Instance.new("Frame", MainFrame),
        Bottom = Instance.new("Frame", MainFrame),
        Left = Instance.new("Frame", MainFrame)
    }
    borders.Top.Size = UDim2.new(1, 0, 0, 3)
    borders.Right.Size = UDim2.new(0, 3, 1, 0)
    borders.Right.Position = UDim2.new(1, -3, 0, 0)
    borders.Bottom.Size = UDim2.new(1, 0, 0, 3)
    borders.Bottom.Position = UDim2.new(0, 0, 1, -3)
    borders.Left.Size = UDim2.new(0, 3, 1, 0)
    game:GetService("RunService").Heartbeat:Connect(function()
        local hue = (tick() * 0.1) % 1
        local color = Color3.fromHSV(hue, 1, 1)
        for _, border in pairs(borders) do
            border.BackgroundColor3 = color
        end
    end)

    -- 标题栏与关闭按钮
    local TitleBar = Instance.new("Frame", MainFrame)
    TitleBar.Size = UDim2.new(1, 0, 0, 30)
    TitleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    local TitleText = Instance.new("TextLabel", TitleBar)
    TitleText.Size = UDim2.new(1, 0, 1, 0)
    TitleText.BackgroundTransparency = 1
    TitleText.Text = "缝合汉化脚本"
    TitleText.TextColor3 = Color3.new(1, 1, 1)
    local CloseBtn = Instance.new("TextButton", TitleBar)
    CloseBtn.Size = UDim2.fromOffset(30, 30)
    CloseBtn.Position = UDim2.new(1, -30, 0, 0)
    CloseBtn.Text = "×"
    CloseBtn.TextColor3 = Color3.new(1, 1, 1)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    CloseBtn.MouseButton1Click:Connect(function() Gui:Destroy() end)

    -- 标签栏
    local TabFrame = Instance.new("Frame", MainFrame)
    TabFrame.Size = UDim2.new(0, 180, 1, 0)
    TabFrame.Position = UDim2.fromOffset(0, 30)
    TabFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)

    -- 通知标签
    local NoticeTab = Instance.new("TextButton", TabFrame)
    NoticeTab.Size = UDim2.new(1, 0, 0, 40)
    NoticeTab.Position = UDim2.fromOffset(0, 0)
    NoticeTab.Text = "通知"
    NoticeTab.TextColor3 = Color3.new(1, 1, 1)
    NoticeTab.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    NoticeTab.MouseButton1Click:Connect(function()
        print("脚本说明：感谢黄某,雪花,本熊,老鼠,乌龟")
    end)

    -- 通用标签（移速调节）
    local GeneralTab = Instance.new("TextButton", TabFrame)
    GeneralTab.Size = UDim2.new(1, 0, 0, 40)
    GeneralTab.Position = UDim2.fromOffset(0, 40)
    GeneralTab.Text = "通用-移速调节"
    GeneralTab.TextColor3 = Color3.new(1, 1, 1)
    GeneralTab.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    GeneralTab.MouseButton1Click:Connect(function()
        local Plr = game:GetService("Players").LocalPlayer
        if Plr.Character then
            local Humanoid = Plr.Character:FindFirstChildOfClass("Humanoid")
            if Humanoid then
                Humanoid.WalkSpeed = 50
                print("移速已调节至50")
            end
        end
    end)

    -- 森林中99个夜晚标签
    local ForestTab = Instance.new("TextButton", TabFrame)
    ForestTab.Size = UDim2.new(1, 0, 0, 40)
    ForestTab.Position = UDim2.fromOffset(0, 80)
    ForestTab.Text = "森林中99个夜晚"
    ForestTab.TextColor3 = Color3.new(1, 1, 1)
    ForestTab.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    ForestTab.MouseButton1Click:Connect(function()
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/xxiaoziyu-source/roblox/a304ee2b7344d37bbef7119436825929212fdaa1/%E8%99%9A%E7%A9%BA%E6%B1%89%E5%8C%96", true))()
            print("虚空汉化加载成功")
        end)
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/xxiaoziyu-source/roblox/fc1074543394626b81c1787b0e56715dec8569ee/TN%E4%B8%AD%E5%BF%83%E6%B1%89%E5%8C%96", true))()
            print("TXD中心汉化加载成功")
        end)
    end)

    -- 偷走脑红标签
    local BrainTab = Instance.new("TextButton", TabFrame)
    BrainTab.Size = UDim2.new(1, 0, 0, 40)
    BrainTab.Position = UDim2.fromOffset(0, 120)
    BrainTab.Text = "偷走脑红"
    BrainTab.TextColor3 = Color3.new(1, 1, 1)
    BrainTab.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    BrainTab.MouseButton1Click:Connect(function()
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/xxiaoziyu-source/T-/72f4dab4fb68a7ba1707c2983759ac36b2538b98/%E7%BA%A2%E8%BE%A3%E6%A4%92%E6%B1%89%E5%8C%96", true))()
            print("红辣椒汉化加载成功")
        end)
    end)

    print("备用方案加载完成")
    return
end

-- 如果 WindUI 加载成功，继续执行主界面代码
local Confirmed = false

WindUI:Popup({
    Title = "欢迎使用本熊汉化",
    Icon = "rbxassetid://112682688917044",
    IconThemed = true,
    Content = "本熊汉化" .. gradient("WindUI", Color3.fromHex("#00FF87"), Color3.fromHex("#60EFFF")) .. " Lib",  
    Buttons = {
        {
            Title = "退出",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "使用",
            Icon = "arrow-right",
            Callback = function() Confirmed = true end,
            Variant = "Primary",
        }
    }
})

repeat wait() until Confirmed

local Window = WindUI:CreateWindow({
    Title = "本熊汉化",
    Icon = "rbxassetid://129260712070622",
    IconThemed = true,
    Author = "本熊汉化",
    Folder = "本熊汉化",
    Size = UDim2.fromOffset(580, 460),
    Transparent = true,
    Theme = "Dark",
    User = {
        Enabled = true,
        Callback = function() print("clicked") end,
        Anonymous = true
    },
    SideBarWidth = 200,
    ScrollBarEnabled = true
})

-- 【新增：给WindUI界面加彩虹边框】
local WindowFrame = Window:GetMainFrame()
local borders = {
    Top = Instance.new("Frame", WindowFrame),
    Right = Instance.new("Frame", WindowFrame),
    Bottom = Instance.new("Frame", WindowFrame),
    Left = Instance.new("Frame", WindowFrame)
}
borders.Top.Size = UDim2.new(1, 0, 0, 3)
borders.Right.Size = UDim2.new(0, 3, 1, 0)
borders.Right.Position = UDim2.new(1, -3, 0, 0)
borders.Bottom.Size = UDim2.new(1, 0, 0, 3)
borders.Bottom.Position = UDim2.new(0, 0, 1, -3)
borders.Left.Size = UDim2.new(0, 3, 1, 0)
game:GetService("RunService").Heartbeat:Connect(function()
    local hue = (tick() * 0.1) % 1
    local color = Color3.fromHSV(hue, 1, 1)
    for _, border in pairs(borders) do
        border.BackgroundColor3 = color
    end
end)

Window:CreateTopbarButton("MyCustomButton1", "bird", function() print("clicked 1!") end, 990)
Window:CreateTopbarButton("MyCustomButton3", "battery-plus", function() Window:ToggleFullscreen() end, 989)

Window:EditOpenButton({
    Title = "本熊汉化",
    Icon = "monitor",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 2,
    Color = ColorSequence.new(Color3.fromHex("FF0F7B"), Color3.fromHex("F89B29")),
    Draggable = true,
})

local Tabs = {
    Home = Window:Tab({ Title = "主页", Icon = "crown" }),
    Main = Window:Tab({ Title = "99夜", Icon = "zap" }),
    Ninja = Window:Tab({ Title = "死铁轨", Icon = "user" }),
}

Window:SelectTab(1)

Tabs.Home:Paragraph({
    Title = "欢迎",
    Desc = "本熊汉化",
})

Tabs.Home:Button({
    Title = "复制QQ群号",
    Callback = function()
        setclipboard("168985587")
        WindUI:Notify({Title = "QQ群号", Content = "群号已复制到剪贴板", Duration = 3})
    end
})

Tabs.Home:Button({
    Title = "老鼠",
    Callback = function()
        setclipboard("lousun7891")
        WindUI:Notify({Title = "快手号", Content = "已复制到剪贴板", Duration = 3})
    end
})

Tabs.Main:Button({
    Title = "h4x(要卡密)",
    Desc = "汉化",
    Callback = function()
        pcall(function()
            local response = loadstring(game:HttpGet("https://raw.githubusercontent.com/jbu7666gvv/h4x6/refs/heads/main/h4x%E6%B1%89%E5%8C%96"))()
            if response and #response > 100 then
                loadstring(response)()
            end
        end)
    end
})

Tabs.Main:Button({
    Title = "虚空(无卡密)",
    Desc = "汉化",
    Callback = function()
        pcall(function()
            local response = loadstring(game:HttpGet("https://raw.githubusercontent.com/jbu7666gvv/xuu/refs/heads/main/xuu"))()
            if response and #response > 100 then
                loadstring(response)()
            end
        end)
    end
})

Tabs.Main:Button({
    Title = "ToastyXD Hub(要卡密)",
    Desc = "汉化",
    Callback = function()
        pcall(function()
            local response = loadstring(game:HttpGet("https://raw.githubusercontent.com/jbu7666gvv/toastyxdhub/refs/heads/main/toastyxdhub"))()
            if response and #response > 100 then
                loadstring(response)()
            end
        end)
    end
})

Tabs.Ninja:Button({
    Title = "RINGTA(无卡密)",
    Desc = "汉化",
    Callback = function()
        pcall(function()
            local response = loadstring(game:HttpGet("https://raw.githubusercontent.com/jbu7666gvv/ringtasi/main/ringtasi"))()
            if response and #response > 100 then
                loadstring(response)()
            end
        end)
    end
})
